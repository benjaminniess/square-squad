webpackJsonp([1],{"/nBd":function(t,e){},EHrm:function(t,e){t.exports={name:"square-squad-reloaded",version:"1.2.5",description:"",main:"index.js",scripts:{start:"node index.js",watch:"npx gulpfile.js",test:"mocha --exit"},author:"",license:"ISC",dependencies:{chai:"^4.3.0",cors:"^2.8.5",dotenv:"^8.6.0",express:"^4.17.1",lodash:"^4.17.21","matter-js":"^0.17.1",mocha:"^8.4.0",newrelic:"^7.5.2","socket.io":"^3.1.2",validator:"^13.6.0"},devDependencies:{"socket.io-client":"^4.1.3",supertest:"^6.1.3"}}},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("//Fk"),o=s.n(a),n=s("7+uW"),r={created:function(){particlesJS.load("particles-js",this.$store.state.homeUrl+"/assets/js/particles.json")},name:"App"},i={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("div",{staticClass:"particles-js",attrs:{id:"particles-js"}}),this._v(" "),e("router-view")],1)},staticRenderFns:[]};var l=s("VU/8")(r,i,!1,function(t){s("uIdU")},null,null).exports,c=s("NYxO"),u=s("Z3T5"),m=s("/ocq"),d={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("h1",{staticClass:"sqsq-logo",attrs:{title:"Square Squad"}},[s("svg",{attrs:{id:"Calque_1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 740.2 242.3"}},[s("polygon",{staticStyle:{fill:"#de5649"},attrs:{points:"63.3 122.9 63.3 153.6 63.3 161.3 63.3 192 94 192 140.1 192 140.1 199.7 63.3 199.7 63.3 230.4 140.1 230.4 170.8 230.4 170.8 199.7 170.8 192 170.8 161.3 140.1 161.3 94 161.3 94 153.6 170.8 153.6 170.8 122.9 94 122.9 63.3 122.9"}}),t._v(" "),s("path",{staticStyle:{fill:"#de5649"},attrs:{d:"M220.5,123.2H189.8V230.8h38.4v11.5h30.7V230.8h38.4V123.2H220.5Zm46.1,76.9h-7.7V188.5H228.2v11.6h-7.7V154h46.1Z"}}),t._v(" "),s("polygon",{staticStyle:{fill:"#de5649"},attrs:{points:"393.1 200.1 347 200.1 347 123.2 316.3 123.2 316.3 200.1 316.3 230.8 347 230.8 393.1 230.8 423.8 230.8 423.8 200.1 423.8 123.2 393.1 123.2 393.1 200.1"}}),t._v(" "),s("path",{staticStyle:{fill:"#de5649"},attrs:{d:"M646.2,122.6H569.4V230.1H676.9V111H646.2Zm0,76.8H600.1V153.3h46.1Z"}}),t._v(" "),s("polygon",{staticStyle:{fill:"#de5649"},attrs:{points:"473.6 123.2 442.8 123.2 442.8 154 442.8 230.8 473.6 230.8 473.6 154 519.6 154 519.6 230.8 550.4 230.8 550.4 154 550.4 123.2 519.6 123.2 473.6 123.2"}}),t._v(" "),s("rect",{staticStyle:{fill:"#64a069"},attrs:{x:"481.6",y:"163.3",width:"30",height:"30"}}),t._v(" "),s("polygon",{staticStyle:{fill:"#1e9294"},attrs:{points:"0 0 0 30.7 0 38.4 0 69.1 30.7 69.1 76.8 69.1 76.8 76.8 0 76.8 0 107.5 76.8 107.5 107.5 107.5 107.5 76.8 107.5 69.1 107.5 38.4 76.8 38.4 30.7 38.4 30.7 30.7 107.5 30.7 107.5 0 30.7 0 0 0"}}),t._v(" "),s("path",{staticStyle:{fill:"#1e9294"},attrs:{d:"M157.2,0H126.5V107.5h38.4v11.6h30.8V107.5h38.4V0H157.2Zm46.1,76.8h-7.6V65.3H164.9V76.8h-7.7V30.7h46.1Z"}}),t._v(" "),s("polygon",{staticStyle:{fill:"#1e9294"},attrs:{points:"329.9 76.8 283.8 76.8 283.8 0 253 0 253 76.8 253 107.5 283.8 107.5 329.9 107.5 360.6 107.5 360.6 76.8 360.6 0 329.9 0 329.9 76.8"}}),t._v(" "),s("polygon",{staticStyle:{fill:"#1e9294"},attrs:{points:"410.3 0 379.6 0 379.6 30.7 379.6 107.5 410.3 107.5 410.3 30.7 456.4 30.7 456.4 107.5 487.1 107.5 487.1 30.7 487.1 0 456.4 0 410.3 0"}}),t._v(" "),s("path",{staticStyle:{fill:"#1e9294"},attrs:{d:"M536.8,0H506.1V107.5h30.7V69.1h30.7v38.4h30.8V69.1h15.3V0H536.8Zm46.1,38.4H536.8V30.7h46.1Z"}}),t._v(" "),s("rect",{staticStyle:{fill:"#edb035"},attrs:{x:"418.3",y:"38.8",width:"30",height:"30"}}),t._v(" "),s("polygon",{staticStyle:{fill:"#1e9294"},attrs:{points:"740.2 0 663.3 0 632.6 0 632.6 30.7 632.6 76.8 632.6 107.5 663.3 107.5 740.2 107.5 740.2 76.8 663.3 76.8 663.3 30.7 740.2 30.7 740.2 0"}}),t._v(" "),s("rect",{staticStyle:{fill:"#edb035"},attrs:{x:"671.2",y:"38.8",width:"30",height:"30"}})])])},staticRenderFns:[]},h=s("VU/8")({name:"Logo"},d,!1,null,null,null).exports,p={render:function(){var t=this.$createElement,e=this._self._c||t;return e("footer",{staticClass:"footer"},[e("p",{staticClass:"text-center"},[e("span",[e("a",{attrs:{href:"https://github.com/benjaminniess/square-squad",target:"_blank"}},[this._v("Version "+this._s(this.version))]),this._v("\n      | "),e("a",{attrs:{href:"#"},on:{click:this.goToAbout}},[this._v("About us")])]),this._v(" "),e("a",{attrs:{href:"https://discord.gg/zGZ2TVw6e4",target:"_blank"}},[e("img",{attrs:{src:"/static/assets/images/discord.png",width:"32px"}})])])])},staticRenderFns:[]},v=s("VU/8")({name:"Footer",computed:{version:function(){return this.$store.state.version}},methods:{goToAbout:function(){this.$router.push("/about-us")}}},p,!1,null,null,null).exports,f={mounted:function(){var t=this;this.$gtag&&this.$gtag.pageview("/"),this.$store.state.socket.on("player-data-updated",function(){t.$route.query.redirect_to?t.$router.push("/rooms/"+t.$route.query.redirect_to):t.$router.push("/rooms")})},destroyed:function(){this.$store.state.socket.off("player-data-updated")},data:function(){return{playerName:localStorage.playerName?localStorage.playerName:null,playerColor:localStorage.playerColor?localStorage.playerColor:"#"+(16777216+16777215*Math.random()).toString(16).substr(1,6)}},name:"Home",components:{Logo:h,Footer:v},methods:{checkForm:function(t){t.preventDefault(),localStorage.playerName=this.playerName,localStorage.playerColor=this.playerColor;var e={name:this.playerName,color:this.playerColor};this.$store.state.socket.emit("update-player-data",e),this.$store.commit("updatePlayerData",e),this.$gtag&&this.$gtag.event("loginUpdate")}}},_={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"super-wrapper"},[s("section",{staticClass:"wrapper"},[s("Logo"),t._v(" "),s("form",{staticClass:"sq-form",attrs:{id:"pre-home-form",method:"post",action:"/"},on:{submit:t.checkForm}},[s("div",{staticClass:"input-field"},[s("label",{attrs:{for:"playerName"}},[t._v("What's your name?")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.playerName,expression:"playerName"}],attrs:{id:"playerName",type:"text",name:"playerName",required:""},domProps:{value:t.playerName},on:{input:function(e){e.target.composing||(t.playerName=e.target.value)}}})]),t._v(" "),s("div",{staticClass:"input-field"},[s("label",{attrs:{for:"playerColor"}},[t._v("What's your favourite color?")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.playerColor,expression:"playerColor"}],attrs:{id:"playerColor",type:"color",name:"playerColor",required:"",value:"#742a55"},domProps:{value:t.playerColor},on:{input:function(e){e.target.composing||(t.playerColor=e.target.value)}}})]),t._v(" "),t._m(0)])],1),t._v(" "),s("Footer")],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"input-field input-submit text-center"},[e("button",{staticClass:"btn",attrs:{type:"submit"}},[this._v("Let's play!")])])}]},g=s("VU/8")(f,_,!1,null,null,null).exports,y={name:"AboutUs",mounted:function(){this.$gtag&&this.$gtag.pageview("/about-us")},components:{Logo:h,Footer:v},methods:{back:function(){this.$router.push("/")}}},k={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"super-wrapper"},[s("section",{staticClass:"wrapper"},[s("Logo"),t._v(" "),s("h3",[t._v("About us")]),t._v(" "),s("h4",[t._v("Benjamin Niess")]),t._v(" "),s("p",[t._v("Backend developer")]),t._v(" "),s("a",{attrs:{href:"https://twitter.com/benjaminniess",target:"_blank"}},[t._v("@benjaminniess")]),t._v(" "),s("h4",[t._v("Axel Roche")]),t._v(" "),s("p",[t._v("Front end developer")]),t._v(" "),s("a",{attrs:{href:"https://twitter.com/MoonPopper",target:"_blank"}},[t._v("@MoonPopper")]),t._v(" "),s("h3",[t._v("Stack")]),t._v(" "),t._m(0),t._v(" "),t._m(1),t._v(" "),s("div",{staticClass:"input-field input-submit text-center"},[s("a",{staticClass:"btn",on:{click:t.back}},[t._v("back")])])],1),t._v(" "),s("Footer")],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("Node JS")]),this._v(" "),e("li",[this._v("Matter JS engine")]),this._v(" "),e("li",[this._v("Socket.io")]),this._v(" "),e("li",[this._v("Vue.js")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",[this._v("\n      Inspired by the amazing\n      "),e("a",{attrs:{href:"http://curvytron.com",target:"_blank"}},[this._v("Curvytron")])])}]},w=s("VU/8")(y,k,!1,null,null,null).exports,b=s("Dd8w"),$=s.n(b),C={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("h4",[t._v("Rounds number")]),t._v(" "),s("p",[s("input",{attrs:{id:"roundsNumber",type:"number",min:"1",max:"100"},domProps:{value:t.roundsNumber},on:{input:t.updateGameOptions}})]),t._v(" "),s("h4",[t._v("Obstacles speed")]),t._v(" "),s("p",[t._v("\n      Slow\n      "),s("input",{attrs:{id:"obstaclesSpeed",type:"range",min:"1",max:"30"},domProps:{value:t.obstaclesSpeed},on:{input:t.updateGameOptions}}),t._v("\n      fast\n    ")]),t._v(" "),s("h4",[t._v("Bonus frequency")]),t._v(" "),s("p",[t._v("\n      No bonus\n      "),s("input",{attrs:{id:"bonusFrequency",type:"range",min:"1",max:"10"},domProps:{value:t.bonusFrequency},on:{input:t.updateGameOptions}}),t._v("\n      Too many bonus\n    ")])])},staticRenderFns:[]},S={name:"LobbySection",components:{Logo:h,AdminForm:s("VU/8")({name:"AdminForm",data:function(){return{roundsNumber:this.$store.state.gameOptions.roundsNumber,obstaclesSpeed:this.$store.state.gameOptions.obstaclesSpeed,bonusFrequency:this.$store.state.gameOptions.bonusFrequency}},methods:{updateGameOptions:function(t){this.$store.commit("updateGameOption",{key:t.target.id,value:t.target.value})}}},C,!1,null,null,null).exports},data:function(){return{roundsNumber:3,obstaclesSpeed:15,bonusFrequency:5}},props:{players:[],room:{}},computed:{isAdmin:function(){var t=this,e=!1;return this.players.map(function(s){s.id===t.currentPlayer&&s.isAdmin&&(e=!0)}),e},currentPlayer:function(){return this.$store.state.socket.id}},methods:{back:function(){this.$router.push("/rooms")},startGame:function(){this.$store.state.socket.emit("start-game",$()({roomSlug:this.room.roomSlug},this.$store.state.gameOptions)),this.$gtag&&this.$gtag.event("startGame",$()({playersCount:this.players.length},this.$store.state.gameOptions))}}},x={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"room-section lobby-section",attrs:{id:"section-lobby"}},[s("div",{staticClass:"wrapper"},[s("Logo"),t._v(" "),s("h3",{staticClass:"rooms-list__title"},[t._v("Room: "+t._s(t.room.roomName))]),t._v(" "),t.players?s("ul",{staticClass:"players-list players no-score"},t._l(t.players,function(e,a){return s("li",{key:a,style:{color:e.color}},[t._v("\n        "+t._s(e.nickname)+"\n        "),e.isAdmin?s("span",[t._v("[Admin]")]):t._e(),t._v(" "),e.id==t.currentPlayer?s("span",[t._v("[You]")]):t._e()])}),0):t._e(),t._v(" "),1==t.isAdmin?s("div",{staticStyle:{visibility:"visible"},attrs:{id:"admin-section"}},[s("AdminForm"),t._v(" "),s("a",{staticClass:"btn",on:{click:t.startGame}},[t._v("play")])],1):t._e(),t._v(" "),s("a",{staticClass:"btn",on:{click:t.back}},[t._v("back")])],1)])},staticRenderFns:[]};var R=s("VU/8")(S,x,!1,function(t){s("bTPe")},"data-v-17d7b636",null).exports,D=s("W3Iv"),N=s.n(D),F=s("BO1k"),P=s.n(F),L=s("d7EF"),V=s.n(L),E=s("RRo+"),H=s.n(E),T={props:{color:{type:String,default:"#000"}},data:function(){return{x:0,y:0,isMouseDown:!1}},computed:{style:function(){return{"--x":this.x+60+"px","--y":this.y+60+"px","--color":""+this.color}}},methods:{handleStart:function(){this.isMouseDown=!0},handleTouch:function(t){var e=V()(t.touches,1)[0],s=e.clientX,a=e.clientY,o=this.$el,n=o.offsetLeft,r=o.offsetTop,i=Math.round(s-n-64),l=Math.round(a-r-64);this.updatePosition(i,l)},handleMove:function(t){var e=t.clientX,s=t.clientY;if(this.isMouseDown){var a=this.$el,o=a.offsetLeft,n=a.offsetTop,r=Math.round(e-o-64),i=Math.round(s-n-64);this.updatePosition(r,i)}},handleRelease:function(){this.emitAll("release"),this.isMouseDown=!1,this.updatePosition(0,0)},updatePosition:function(t,e){var s=Math.atan2(e,t);this.x=this.speed>48?48*Math.cos(s):t,this.y=this.speed>=48?48*Math.sin(s):e,this.emitAll()},emitAll:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"change";this.$emit(t,{x:this.x,y:this.y})}},mounted:function(){this.emitAll()}},j={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"vue-joystick",style:this.style,on:{touchmove:this.handleTouch,mousemove:this.handleMove,mousedown:this.handleStart,mouseup:this.handleRelease,touchend:this.handleRelease}})},staticRenderFns:[]};var O={name:"GameSection",mounted:function(){var t=this;this.$store.state.socket;window.addEventListener("keydown",this.keyDownHandler),window.addEventListener("keyup",this.keyUpHandler),document.getElementById("particles-js").style.opacity=0,this.$store.state.socket.on("start-game-result",function(e){e.success&&(t.pointsText=null)});var e=document.getElementById("gameCanvas"),s=e?e.getContext("2d"):null,a=new Image;a.src=this.$store.state.homeUrl+"/assets/images/bonus.png";var o=Date.now(),n=!0;this.$store.state.socket.on("refresh-canvas",function(r){var i=window.innerWidth>700?700:window.innerWidth;function l(t){return t*i/700}t.canvasWidth=i;var c=Date.now();c-o>200&&(n=!n,o=c),H()(r.score)&&(t.pointsText=r.score),s.clearRect(0,0,e.width,e.height),r.bonusList.map(function(t){s.beginPath(),s.drawImage(a,t.imgX,t.imgY,100,100,l(t.x),l(t.y),l(t.width),l(t.height)),s.fillStyle="#00DD00",s.fill(),s.closePath()}),r.debugBodies.length>0&&r.debugBodies.map(function(t,e){s.beginPath(),s.rect(l(t.x-5),l(t.y-5),l(10),l(10)),s.fillStyle="#DDDD00",s.fill(),s.closePath()}),r.obstacles.map(function(t){s.beginPath(),s.fillStyle="#DD0000",t.map(function(t,e){0===e?s.moveTo(l(t.x),l(t.y)):s.lineTo(l(t.x),l(t.y))}),s.fill(),s.closePath()});var u=!0,m=!1,d=void 0;try{for(var h,p=P()(N()(r.players));!(u=(h=p.next()).done);u=!0){var v=h.value,f=V()(v,2),_=f[0],g=f[1];g.alive?(s.beginPath(),s.rect(l(g.x-15),l(g.y-15),l(30),l(30)),s.fillStyle=g.color,s.fill(),s.closePath(),!g.bonus||g.bonusBlinking&&!n||(s.beginPath(),s.drawImage(a,g.bonus.imgX,g.bonus.imgY,100,100,l(g.x+15),l(g.y+15),l(2*g.bonus.width/3),l(2*g.bonus.height/3)),s.fillStyle="#00DD00",s.fill(),s.closePath())):_===t.currentPlayer&&(s.font="30px 'Zen Dots', cursive",s.textAlign="center",s.fillStyle="#de564a",s.fillText("You are DEAD!",l(e.width/2),l(e.width/2)))}}catch(t){m=!0,d=t}finally{try{!u&&p.return&&p.return()}finally{if(m)throw d}}})},destroyed:function(){this.$store.state.socket.off("refresh-canvas"),window.removeEventListener("keyup",this.keyUpHandler),window.removeEventListener("keydown",this.keyDownHandler),document.getElementById("particles-js").style.opacity=1,this.$store.state.socket.off("start-game-result")},computed:{currentPlayer:function(){return this.$store.state.socket.id}},data:function(){return{canvasWidth:window.innerWidth>700?700:window.innerWidth,pointsText:null}},props:{players:[],room:{},gameData:{}},components:{Logo:h,Joystick:s("VU/8")(T,j,!1,function(t){s("raGJ")},null,null).exports},methods:{keyDownHandler:function(t){this.pressKey(t.keyCode)},keyUpHandler:function(t){this.releaseKey(t.keyCode)},handleChange:function(t){t.x<-20?this.pressKey(37):t.x>20?this.pressKey(39):(this.releaseKey(39),this.releaseKey(37)),t.y<-20?this.pressKey(38):t.y>20?this.pressKey(40):(this.releaseKey(38),this.releaseKey(40))},pressKey:function(t){this.$store.state.socket.emit("keyPressed",{key:t})},releaseKey:function(t){this.$store.state.socket.emit("keyUp",{key:t})}}},A={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"room-section play-section",attrs:{id:"section-play"}},[s("div",{staticClass:"play-section__wrapper"},[s("aside",{staticClass:"play-section__aside"},[s("Logo"),t._v(" "),s("div",{staticClass:"play-section__infos"},[s("h3",{staticClass:"rooms-list__title"},[t._v("Room: "+t._s(t.room.roomName))]),t._v(" "),s("h4",{attrs:{id:"round-number"}},[t._v("\n          Round "+t._s(t.gameData.currentRound)+"/"+t._s(t.gameData.totalRounds)+"\n        ")]),t._v(" "),t.players?s("ul",{staticClass:"players-list players"},t._l(t.players,function(e,a){return s("li",{key:a,style:{color:e.color}},[t._v("\n            "+t._s(e.nickname)+"\n            "),t._v(" "),e.id==t.currentPlayer?s("span",[t._v("[You]")]):t._e(),t._v(" "),!0!==e.alive?s("span",[t._v("[Dead]")]):t._e(),t._v(" "),s("span",[t._v("["+t._s(e.score)+"]")])])}),0):t._e(),t._v(" "),t.pointsText?s("h1",[t._v("\n          "+t._s(t.pointsText)+"\n        ")]):t._e()])],1),t._v(" "),s("div",{staticClass:"play-section__canvas"},[t.gameData.timeLeft>0?s("h1",{staticClass:"play-section__countdown",staticStyle:{opacity:"1"},attrs:{id:"countdown-text"}},[t._v("\n        "+t._s(t.gameData.timeLeft)+"\n      ")]):t._e(),t._v(" "),s("canvas",{attrs:{id:"gameCanvas",width:t.canvasWidth,height:t.canvasWidth}}),t._v(" "),s("div",{staticClass:"play-section__joystick"},[s("Joystick",{on:{change:function(e){return t.handleChange(e)}}})],1)])])])},staticRenderFns:[]},q={name:"RankSection",computed:{winner:function(){var t=this;return this.ranking.roundWinner?$()({},this.players.find(function(e){return e.id===t.ranking.roundWinner.playerID}),{score:this.ranking.roundWinner.score}):null}},methods:{formatedRanking:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"roundRanking";if(!this.ranking[e])return null;var s=[];return this.ranking[e].map(function(e){s.push($()({},t.players.find(function(t){return t.id===e.playerID}),{score:e.score}))}),s},back:function(){this.$store.commit("updateGameStatus","waiting")}},props:{room:{},ranking:[],players:{},gameIsOver:!1},components:{Logo:h,Footer:v}},I={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"room-section ranking-section",attrs:{id:"section-ranking"}},[s("div",{staticClass:"wrapper"},[s("Logo"),t._v(" "),s("div",{staticClass:"text-center"},[s("h3",{staticClass:"rooms-list__title"},[t._v("Room: "+t._s(t.room.roomName))])]),t._v(" "),s("table",{staticClass:"winner-annoucement",attrs:{id:"winner-announcement"}},[s("tbody",[t.winner?s("tr",[s("td",[t._v("Winner")]),t._v(" "),s("td",[s("span",{staticClass:"user-name",style:{color:t.winner.color}},[s("span",[t._v(t._s(t.winner.nickname))])])])]):t._e(),t._v(" "),t.winner?s("tr",[s("td",[t._v("Point(s)")]),t._v(" "),s("td",[s("p",[t._v(t._s(t.winner.score)+" pts")])])]):t._e()])]),t._v(" "),s("h3",[t._v("Round results")]),t._v(" "),s("ul",{staticClass:"players-list",attrs:{id:"round-rank-list"}},t._l(t.formatedRanking(),function(e){return s("li",{key:e.id,style:{color:e.color}},[t._v("\n        "+t._s(e.nickname)+" ("+t._s(e.score)+" points)\n      ")])}),0),t._v(" "),s("h3",[t._v("Global ranking")]),t._v(" "),s("ul",{staticClass:"players-list",attrs:{id:"rank-list"}},t._l(t.formatedRanking("ranking"),function(e){return s("li",{key:e.id,style:{color:e.color}},[t._v("\n        "+t._s(e.nickname)+" ("+t._s(e.score)+" points)\n      ")])}),0),t._v(" "),t.gameIsOver?s("button",{staticClass:"btn",attrs:{id:"back-button"},on:{click:t.back}},[t._v("\n      Back\n    ")]):t._e()],1)])},staticRenderFns:[]},G={name:"App",components:{LobbySection:R,GameSection:s("VU/8")(O,A,!1,null,null,null).exports,RankSection:s("VU/8")(q,I,!1,null,null,null).exports,Logo:h,Footer:v},data:function(){return{players:[],room:{},gameData:{timeLeft:null},gameIsOver:!1,ranking:[],isAdmin:!1}},computed:{status:function(){return this.$store.state.gameStatus}},watch:{status:function(t,e){if(this.$gtag){var s="default";"playing"===t?s="/play":"waiting"===t?s="/lobby":"end-round"===t&&(s="/ranking"),this.$gtag.pageview(s)}}},mounted:function(){var t=this;this.$gtag&&this.$gtag.pageview("/lobby"),null===this.$store.state.playerData&&this.$router.push("/?redirect_to="+this.$route.params.id),this.$store.state.socket.emit("room-join",{roomSlug:this.$route.params.id}),this.$store.state.socket.on("room-join-result",function(e){e.success&&(t.room=e.data)}),this.$store.state.socket.on("refresh-players",function(e){t.players=e}),this.$store.state.socket.on("start-game-result",function(e){e.success&&(t.gameData.currentRound=e.data.currentRound,t.gameData.totalRounds=e.data.totalRounds,t.$store.commit("updateGameStatus","playing"),t.gameIsOver=!1)}),this.$store.state.socket.on("countdown-update",function(e){t.gameData.timeLeft=parseInt(e.timeleft)}),this.$store.state.socket.on("in-game-countdown-update",function(e){if(t.gameData.timeLeft=parseInt(e.timeleft),0==e.timeleft)if(t.gameData.timeLeft="Game over",t.ranking=e,t.$store.commit("updateGameStatus","end-round"),"waiting"===e.gameStatus)t.gameIsOver=!0;else var s=3,a=t.$store.state.socket,o=t.gameData,n=t.room,r=setInterval(function(){s<=0&&(clearInterval(r),a.emit("start-game",{roomSlug:n.roomSlug}),o.timeLeft="Starting..."),s-=1},1e3)})},destroyed:function(){this.$store.state.socket.off("refresh-players"),this.$store.state.socket.off("room-joined"),this.$store.state.socket.off("start-game-result"),this.$store.state.socket.off("countdown-update"),this.$store.state.socket.off("in-game-countdown-update"),this.$store.state.socket.emit("room-leave")}},U={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"super-wrapper"},[t._m(0),t._v(" "),s("LobbySection",{directives:[{name:"show",rawName:"v-show",value:"waiting"==t.status,expression:"status == 'waiting'"}],attrs:{players:t.players,room:t.room,isAdmin:t.isAdmin}}),t._v(" "),s("GameSection",{directives:[{name:"show",rawName:"v-show",value:"playing"==t.status,expression:"status == 'playing'"}],attrs:{players:t.players,room:t.room,isAdmin:t.isAdmin,gameData:t.gameData}}),t._v(" "),s("RankSection",{directives:[{name:"show",rawName:"v-show",value:"end-round"==t.status,expression:"status == 'end-round'"}],attrs:{room:t.room,gameIsOver:t.gameIsOver,players:t.players,ranking:t.ranking}}),t._v(" "),s("Footer")],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"particles-js",attrs:{id:"particles-js"}},[e("canvas",{staticClass:"particles-js-canvas-el",staticStyle:{width:"100%",height:"100%"},attrs:{width:"1905",height:"525"}})])}]};var M=s("VU/8")(G,U,!1,function(t){s("Pb8w")},null,null).exports,W={name:"Rooms",data:function(){return{rooms:[],newRoomName:null}},mounted:function(){var t=this;this.$gtag&&this.$gtag.pageview("/rooms"),null===this.$store.state.playerData&&this.$router.push("/"),this.$store.state.socket.on("rooms-refresh-result",function(e){e.success?0===e.data.length?t.rooms=[]:t.rooms=e.data:t.goToHome()}),this.$store.state.socket.on("rooms-create-result",function(e){e.success?(t.$gtag&&t.$gtag.event("roomCreated"),t.goToRoom(e.data.roomSlug)):t.goToHome()}),this.refreshRooms()},destroyed:function(){this.$store.state.socket.off("rooms-refresh-result"),this.$store.state.socket.off("rooms-create-result")},components:{Logo:h,Footer:v},methods:{refreshRoomsEventHandler:function(t){t.preventDefault(),this.$gtag&&this.$gtag.event("roomsRefresh"),this.refreshRooms()},refreshRooms:function(){this.$store.state.socket.emit("rooms-refresh")},checkForm:function(t){t.preventDefault(),this.$store.state.socket.emit("rooms-create",this.newRoomName)},goToRoom:function(t){this.$router.push("/rooms/"+t)},goToHome:function(){this.$router.push("/")}},computed:{playerData:function(){return this.$store.state.playerData}}},B={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"super-wrapper"},[t._m(0),t._v(" "),s("section",{staticClass:"wrapper"},[s("Logo"),t._v(" "),s("h3",[t._v("Rooms list")]),t._v(" "),s("div",{staticClass:"page-rooms__intro"},[s("p",{staticClass:"text-center"},[s("a",{staticClass:"user-name",style:{color:t.playerData?t.playerData.color:null},attrs:{href:"#",id:"playerNameLabel"},on:{click:t.goToHome}},[s("span",[t._v(t._s(t.playerData?t.playerData.name:null))])])]),t._v(" "),s("p",[t._v("You first need to select a room or create a new one")])]),t._v(" "),s("a",{attrs:{id:"rooms-refresh",href:"#"},on:{click:t.refreshRoomsEventHandler}},[t._v("[Refresh]")]),t._v(" "),s("div",{staticClass:"rooms-list"},[s("h3",{staticClass:"rooms-list__title"},[t._v("Join a room…")]),t._v(" "),s("div",{attrs:{id:"rooms-holder"}},[t.rooms.length>0?s("ul",{staticClass:"rooms-list__list"},t._l(t.rooms,function(e){return s("li",{key:e.id,staticClass:"rooms-list__item"},[s("a",{staticClass:"rooms-list__link",attrs:{href:"#"},on:{click:function(s){return t.goToRoom(e.slug)}}},[t._v(t._s(e.name))])])}),0):s("p",{staticClass:"rooms-list__no-rooms"},[t._v("No rooms yet :(")])])]),t._v(" "),s("form",{staticClass:"sq-form",attrs:{method:"post",action:"#"},on:{submit:t.checkForm}},[s("div",{staticClass:"input-field"},[s("label",{attrs:{for:"newRoom"}},[t._v("Or create a new one?")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.newRoomName,expression:"newRoomName"}],attrs:{id:"newRoom",placeholder:"Give it a name",required:"",type:"text"},domProps:{value:t.newRoomName},on:{input:function(e){e.target.composing||(t.newRoomName=e.target.value)}}})]),t._v(" "),t._m(1)])],1),t._v(" "),s("Footer")],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"particles-js",attrs:{id:"particles-js"}},[e("canvas",{staticClass:"particles-js-canvas-el",staticStyle:{width:"100%",height:"100%"},attrs:{width:"1905",height:"525"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"input-field input-submit text-center"},[e("button",{staticClass:"btn",attrs:{type:"submit"}},[this._v("Create room")])])}]};var K=s("VU/8")(W,B,!1,function(t){s("/nBd")},null,null).exports,Z={name:"Page404",components:{Logo:h,Footer:v},mounted:function(){this.$gtag&&this.$gtag.pageview(this.$route)},methods:{back:function(){this.$router.push("/")}}},J={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"super-wrapper"},[e("section",{staticClass:"wrapper"},[e("Logo"),this._v(" "),e("h1",[this._v("There's nothing here")]),this._v(" "),e("img",{attrs:{src:"https://media.giphy.com/media/3o7aCTPPm4OHfRLSH6/giphy.gif",width:"480",height:"360"}}),this._v(" "),e("a",{staticClass:"btn",on:{click:this.back}},[this._v("back")])],1),this._v(" "),e("Footer")],1)},staticRenderFns:[]},Y=s("VU/8")(Z,J,!1,null,null,null).exports,X=s("x6bz"),z="";new o.a(function(t,e){var s=new XMLHttpRequest;s.open("GET",z+"/env",!0),s.onload=function(a){200!==s.status||4!==s.readyState?e("loading error."):t(JSON.parse(s.responseText))},s.send(null)}).then(function(t){!function(t){var e=Object(X.io)(z,{transports:["websocket"]}),a=s("EHrm");n.a.config.productionTip=!1,t.ga_id&&n.a.use(u.a,{config:{id:t.ga_id,params:{send_page_view:!1}}});n.a.use(c.a),n.a.use(m.a);var o=new c.a.Store({state:{version:a.version,homeUrl:z,socket:e,playerData:null,gameID:"panic-attack",gameStatus:"waiting",gameOptions:{roundsNumber:3,obstaclesSpeed:10,bonusFrequency:5}},mutations:{updatePlayerData:function(t,e){t.playerData=e},updateGameStatus:function(t,e){t.gameStatus=e},updateGameOption:function(t,e){t.gameOptions[e.key]=e.value},setGameStatus:function(t,e){particles.style.display="playing"===e?"none":"block",t.status=e}}}),r=new m.a({mode:"history",routes:[{path:"/",component:g},{path:"/rooms",component:K},{path:"/rooms/:id",component:M},{path:"/about-us",component:w},{path:"*",component:Y}]});new n.a({router:r,store:o,render:function(t){return t(l)}}).$mount("#app")}(t)}).catch(function(t){alert(t)})},Pb8w:function(t,e){},bTPe:function(t,e){},raGJ:function(t,e){},uIdU:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.js.map